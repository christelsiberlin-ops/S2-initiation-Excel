<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Suivi Formation Excel - GEA S1</title>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body>
    <div id="root"></div>
    
    <script type="text/babel">
        const { useState, useEffect } = React;
        
        // Ic√¥nes Lucide en JSX
        const CheckSquare = () => (
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <polyline points="9 11 12 14 22 4"></polyline>
                <path d="M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11"></path>
            </svg>
        );
        
        const Square = () => (
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
            </svg>
        );
        
        const User = () => (
            <svg xmlns="http://www.w3.org/2000/svg" width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
                <circle cx="12" cy="7" r="4"></circle>
            </svg>
        );
        
        const BarChart3 = () => (
            <svg xmlns="http://www.w3.org/2000/svg" width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <path d="M3 3v18h18"></path>
                <path d="M18 17V9"></path>
                <path d="M13 17V5"></path>
                <path d="M8 17v-3"></path>
            </svg>
        );
        
        const BookOpen = () => (
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z"></path>
                <path d="M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z"></path>
            </svg>
        );
        
        const Award = () => (
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <circle cx="12" cy="8" r="7"></circle>
                <polyline points="8.21 13.89 7 23 12 20 17 23 15.79 13.88"></polyline>
            </svg>
        );
        
        const Youtube = () => (
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <path d="M22.54 6.42a2.78 2.78 0 0 0-1.94-2C18.88 4 12 4 12 4s-6.88 0-8.6.46a2.78 2.78 0 0 0-1.94 2A29 29 0 0 0 1 11.75a29 29 0 0 0 .46 5.33A2.78 2.78 0 0 0 3.4 19c1.72.46 8.6.46 8.6.46s6.88 0 8.6-.46a2.78 2.78 0 0 0 1.94-2 29 29 0 0 0 .46-5.25 29 29 0 0 0-.46-5.33z"></path>
                <polygon points="9.75 15.02 15.5 11.75 9.75 8.48 9.75 15.02"></polygon>
            </svg>
        );

        // ‚úÖ URL MISE √Ä JOUR
        const GOOGLE_SCRIPT_URL = "https://script.google.com/macros/s/AKfycbxBr6NhpqTBX0dAiezYg9sPvP8YGor7EVQP_JQcqQkGYjaLf2OphGx-wLREANgdG7Uz/exec";
        
        // Fonction pour envoyer les donn√©es √† Google Sheets
        async function envoyerAGoogleSheets(data) {
          if (!GOOGLE_SCRIPT_URL) {
            console.log("‚ùå URL Google Script non configur√©e");
            return;
          }
          
          console.log("üì§ Envoi √† Google Sheets:", data);
          
          try {
            const response = await fetch(GOOGLE_SCRIPT_URL, {
              method: 'POST',
              headers: {
                'Content-Type': 'application/json',
              },
              body: JSON.stringify(data),
              redirect: 'follow'
            });
            console.log("‚úÖ Donn√©es envoy√©es avec succ√®s");
          } catch (error) {
            console.error("‚ùå Erreur envoi Google Sheets:", error);
          }
        }

        // DONN√âES - Vos 57 √©tudiants GEA S1
        const students = [
          { id: 1, nom: "ABKARI", prenom: "Riyad", groupe: "TD1", groupeTP: "TPA" },
          { id: 2, nom: "ALAHYANE", prenom: "Adel", groupe: "TD1", groupeTP: "TPA" },
          { id: 3, nom: "BADAR", prenom: "Tahsan Bin", groupe: "TD2", groupeTP: "" },
          { id: 4, nom: "BARTH", prenom: "Albin", groupe: "TD1", groupeTP: "TPA" },
          { id: 5, nom: "BEAUCHAMP", prenom: "Johannie", groupe: "TD1", groupeTP: "TPA" },
          { id: 6, nom: "BELKAID", prenom: "Ibrahim", groupe: "TD2", groupeTP: "" },
          { id: 7, nom: "BENMEHAL", prenom: "Mohamed", groupe: "TD1", groupeTP: "TPA" },
          { id: 8, nom: "BERTRAND", prenom: "Adam", groupe: "TD2", groupeTP: "" },
          { id: 9, nom: "BESSON", prenom: "Timoth√©", groupe: "TD1", groupeTP: "TPA" },
          { id: 10, nom: "BITA", prenom: "Moses", groupe: "TD2", groupeTP: "" },
          { id: 11, nom: "BOUDJEMAI", prenom: "F√©riel", groupe: "TD2", groupeTP: "" },
          { id: 12, nom: "BOULAU", prenom: "Titouan", groupe: "TD1", groupeTP: "TPA" },
          { id: 13, nom: "BOUSFOUL", prenom: "Lyna-Tounsia", groupe: "TD2", groupeTP: "" },
          { id: 14, nom: "CADOT", prenom: "Thibaut", groupe: "TD2", groupeTP: "" },
          { id: 15, nom: "CAILLAUD", prenom: "Ambre", groupe: "TD2", groupeTP: "" },
          { id: 16, nom: "CASSOU", prenom: "Guilhem", groupe: "TD2", groupeTP: "" },
          { id: 17, nom: "CHAIR", prenom: "Myriam", groupe: "TD2", groupeTP: "" },
          { id: 18, nom: "CHASSAING", prenom: "Alexandre", groupe: "TD2", groupeTP: "" },
          { id: 19, nom: "CONSTANS", prenom: "Philom√®ne", groupe: "TD1", groupeTP: "TPA" },
          { id: 20, nom: "CORREIA TE", prenom: "Enzo", groupe: "TD1", groupeTP: "TPA" },
          { id: 21, nom: "DANG ATIOCK", prenom: "Njock-M√©lissa", groupe: "TD1", groupeTP: "TPA" },
          { id: 22, nom: "DE LA FAYOLLE DE MARS", prenom: "Gabriel", groupe: "TD1", groupeTP: "TPA" },
          { id: 23, nom: "DIABI", prenom: "C√©dric", groupe: "TD2", groupeTP: "" },
          { id: 24, nom: "DKAKI", prenom: "Sofiane", groupe: "TD1", groupeTP: "TPA" },
          { id: 25, nom: "DOMBRAY", prenom: "Valentin", groupe: "TD1", groupeTP: "TPA" },
          { id: 26, nom: "DUPUY", prenom: "Gabriel", groupe: "TD2", groupeTP: "" },
          { id: 27, nom: "EL AATTAR", prenom: "Marwa", groupe: "TD1", groupeTP: "TPA" },
          { id: 28, nom: "√âTOURNEAU", prenom: "Thibaud", groupe: "TD1", groupeTP: "TPA" },
          { id: 29, nom: "FERBOURS", prenom: "Lucas", groupe: "TD1", groupeTP: "TPA" },
          { id: 30, nom: "FERNANDES-CLAVERIE", prenom: "Mathis", groupe: "TD1", groupeTP: "TPA" },
          { id: 31, nom: "FEROLDI", prenom: "Mathieu", groupe: "TD2", groupeTP: "" },
          { id: 32, nom: "FERT", prenom: "Raphael", groupe: "TD2", groupeTP: "" },
          { id: 33, nom: "GEYMET", prenom: "Audrey", groupe: "TD2", groupeTP: "" },
          { id: 34, nom: "GNANARAJ", prenom: "Priyanga", groupe: "TD2", groupeTP: "" },
          { id: 35, nom: "GROSJEAN", prenom: "Rapha√´l", groupe: "TD2", groupeTP: "" },
          { id: 36, nom: "HUREL", prenom: "Timoth√©e", groupe: "TD2", groupeTP: "" },
          { id: 37, nom: "KEBAILI", prenom: "Dany", groupe: "TD2", groupeTP: "" },
          { id: 38, nom: "KENDINE BOUONGNON", prenom: "Luc Rigson", groupe: "TD2", groupeTP: "" },
          { id: 39, nom: "KLEIT", prenom: "Hadi", groupe: "TD2", groupeTP: "" },
          { id: 40, nom: "KOURILSKY", prenom: "Nitsa", groupe: "TD2", groupeTP: "" },
          { id: 41, nom: "LANZARONE", prenom: "Gianni", groupe: "TD2", groupeTP: "" },
          { id: 42, nom: "LAPOINTE", prenom: "Davidson", groupe: "TD1", groupeTP: "TPA" },
          { id: 43, nom: "LEROUXEL", prenom: "Gabrielle", groupe: "TD1", groupeTP: "TPA" },
          { id: 44, nom: "LUREL", prenom: "Melvyn", groupe: "TD1", groupeTP: "TPA" },
          { id: 45, nom: "MEYER", prenom: "Clo√©", groupe: "TD1", groupeTP: "TPA" },
          { id: 46, nom: "OULHOUSSAINE", prenom: "Lokmene", groupe: "TD2", groupeTP: "" },
          { id: 47, nom: "OUSSET", prenom: "Maud", groupe: "TD1", groupeTP: "TPA" },
          { id: 48, nom: "POMMIES", prenom: "Victor", groupe: "TD1", groupeTP: "TPA" },
          { id: 49, nom: "PUPIN", prenom: "Romain", groupe: "TD2", groupeTP: "" },
          { id: 50, nom: "PURCSA", prenom: "Alexandru", groupe: "TD1", groupeTP: "TPA" },
          { id: 51, nom: "SAKAL", prenom: "Husna", groupe: "TD1", groupeTP: "TPA" },
          { id: 52, nom: "TARDIVEL", prenom: "Pierre", groupe: "TD1", groupeTP: "TPA" },
          { id: 53, nom: "TELLIER", prenom: "Anna", groupe: "TD1", groupeTP: "TPA" },
          { id: 54, nom: "THIOYE", prenom: "Amadou", groupe: "TD2", groupeTP: "" },
          { id: 55, nom: "VOISENET", prenom: "Mathis", groupe: "TD1", groupeTP: "TPA" },
          { id: 56, nom: "WATTEBLED", prenom: "Victor", groupe: "TD2", groupeTP: "" },
          { id: 57, nom: "WEGERA--BESSON", prenom: "Antoine", groupe: "TD1", groupeTP: "TPA" }
        ];

        const courseStructure = {
          niveau1: {
            title: "Niveau 1 - Basique",
            playlistCours: "https://www.youtube.com/watch?v=VF2uSP1CFMQ&list=PLoolrb8qXoJgAHld6i8spYcoSSc9InMLf",
            playlistExercices: "https://www.youtube.com/watch?v=zlXZqTwwdyI&list=PLoolrb8qXoJggYYlRQw46oCrnJ6WZywm3",
            videos: [
              { titre: "Introduction et prise en main", quiz: "quiz-n1-v1.html" },
              { titre: "Saisie et mise en forme des donn√©es", quiz: "quiz-n1-v2.html" },
              { titre: "Formules simples (SOMME, MOYENNE, MIN, MAX)", quiz: "quiz-n1-v3.html" },
              { titre: "Mise en forme conditionnelle", quiz: "quiz-n1-v4.html" },
              { titre: "Graphiques simples", quiz: "quiz-n1-v5.html" },
              { titre: "Filtres et tris basiques", quiz: "quiz-n1-v6.html" }
            ],
            exercices: [
              "Exercice 1 - Tableau de budget",
              "Exercice 2 - Analyse de donn√©es simples"
            ]
          },
          niveau2: {
            title: "Niveau 2 - Interm√©diaire",
            playlistCours: "https://www.youtube.com/watch?v=fE6ZIztg3Rc&list=PLoolrb8qXoJhKqF7NNJrXCbJ2pJsbZrcz",
            playlistExercices: "https://www.youtube.com/watch?v=cayeg4b-VBQ&list=PLoolrb8qXoJiM32J7GsAI6hOKqkpcV7JH",
            videos: [
              { titre: "Fonctions logiques (SI, ET, OU)", quiz: "quiz-n2-v1.html" },
              { titre: "Fonctions de recherche (RECHERCHEV)", quiz: "quiz-n2-v2.html" },
              { titre: "Tableaux crois√©s dynamiques", quiz: "quiz-n2-v3.html" },
              { titre: "Graphiques avanc√©s", quiz: "quiz-n2-v4.html" },
              { titre: "Bases de donn√©es et filtres √©labor√©s", quiz: "quiz-n2-v5.html" },
              { titre: "Fonctions texte et date", quiz: "quiz-n2-v6.html" }
            ],
            exercices: [
              "Exercice 1 - Gestion de stock",
              "Exercice 2 - Tableau de bord commercial"
            ]
          },
          niveau3: {
            title: "Niveau 3 - Avanc√© (BONUS)",
            bonus: true,
            playlistCours: "https://www.youtube.com/watch?v=oz35P_Xpat0&list=PLoolrb8qXoJgFdctBDiX81_AnrGVOd-qL",
            playlistExercices: "https://www.youtube.com/watch?v=DZ3o6HOrM6M&list=PLoolrb8qXoJglLeM21MR2vWINY6UBx3SZ",
            videos: [
              { titre: "Macros et VBA - Introduction", quiz: "" },
              { titre: "Automatisation des t√¢ches", quiz: "" },
              { titre: "Fonctions avanc√©es et imbriqu√©es", quiz: "" },
              { titre: "Power Query et Power Pivot", quiz: "" },
              { titre: "Tableaux de bord professionnels", quiz: "" }
            ],
            exercices: [
              "Exercice 1 - Automatisation compl√®te",
              "Exercice 2 - Dashboard interactif"
            ]
          }
        };

        const sessions = [
          { num: 1, duree: "1h50", content: "Niveau 1 - Vid√©os 1-3", objectif: "D√©couverte Excel" },
          { num: 2, duree: "1h50", content: "Niveau 1 - Vid√©os 4-6 + Exercice 1", objectif: "Ma√Ætrise basique" },
          { num: 3, duree: "1h50", content: "Niveau 1 - Exercice 2 + R√©visions", objectif: "Consolidation" },
          { num: 4, duree: "1h50", content: "üî¥ √âVALUATION 1", objectif: "Validation niveau 1" },
          { num: 5, duree: "1h50", content: "Niveau 2 - Vid√©os 1-3", objectif: "Fonctions avanc√©es" },
          { num: 6, duree: "1h50", content: "Niveau 2 - Vid√©os 4-6", objectif: "TCD et graphiques" },
          { num: 7, duree: "1h50", content: "Niveau 2 - Exercices 1-2", objectif: "Pratique intensive" },
          { num: 8, duree: "1h50", content: "R√©visions g√©n√©rales et questions", objectif: "Pr√©paration finale" },
          { num: 9, duree: "1h50", content: "üî¥ √âVALUATION 2 FINALE", objectif: "Validation compl√®te" }
        ];

        // APPLICATION PRINCIPALE
        const ExcelTrackingApp = () => {
          const [currentView, setCurrentView] = useState('select');
          const [currentStudent, setCurrentStudent] = useState(null);
          const [filterGroupe, setFilterGroupe] = useState('tous');
          
          // Chargement depuis localStorage
          const [progress, setProgress] = useState(() => {
            const saved = localStorage.getItem('excelProgress');
            return saved ? JSON.parse(saved) : {};
          });

          // Sauvegarde automatique dans localStorage
          useEffect(() => {
            localStorage.setItem('excelProgress', JSON.stringify(progress));
          }, [progress]);

          const getStudentProgress = (studentId) => {
            if (!progress[studentId]) {
              return {
                niveau1: {
                  videos: Array(courseStructure.niveau1.videos.length).fill(false),
                  exercices: Array(courseStructure.niveau1.exercices.length).fill(false)
                },
                niveau2: {
                  videos: Array(courseStructure.niveau2.videos.length).fill(false),
                  exercices: Array(courseStructure.niveau2.exercices.length).fill(false)
                },
                niveau3: {
                  videos: Array(courseStructure.niveau3.videos.length).fill(false),
                  exercices: Array(courseStructure.niveau3.exercices.length).fill(false)
                },
                eval1: false,
                eval2: false
              };
            }
            return progress[studentId];
          };

          const toggleItem = (studentId, niveau, type, index) => {
            setProgress(prev => {
              const studentProg = getStudentProgress(studentId);
              const newProg = JSON.parse(JSON.stringify(studentProg));
              
              if (type === 'video' || type === 'exercice') {
                newProg[niveau][type === 'video' ? 'videos' : 'exercices'][index] = 
                  !newProg[niveau][type === 'video' ? 'videos' : 'exercices'][index];
                
                // Envoyer √† Google Sheets - SUIVI
                const student = students.find(s => s.id === studentId);
                if (student && GOOGLE_SCRIPT_URL) {
                  const nomComplet = `${student.prenom} ${student.nom}`;
                  const elementNom = type === 'video' 
                    ? courseStructure[niveau].videos[index].titre 
                    : courseStructure[niveau].exercices[index];
                  
                  envoyerAGoogleSheets({
                    type: 'suivi',
                    nom: nomComplet,
                    typeAction: type,
                    niveau: niveau,
                    element: elementNom,
                    statut: newProg[niveau][type === 'video' ? 'videos' : 'exercices'][index] ? 'coch√©' : 'd√©coch√©'
                  });
                  
                  // Calculer et envoyer la PROGRESSION mise √† jour
                  setTimeout(() => {
                    const updatedProgress = { ...prev, [studentId]: newProg };
                    const progressPercent = calculateProgressFromData(studentId, updatedProgress);
                    
                    envoyerAGoogleSheets({
                      type: 'progression',
                      nom: nomComplet,
                      groupe: student.groupe,
                      progression: progressPercent
                    });
                  }, 100);
                }
              } else if (type === 'eval') {
                newProg[niveau] = !newProg[niveau];
                
                // Envoyer √† Google Sheets - SUIVI
                const student = students.find(s => s.id === studentId);
                if (student && GOOGLE_SCRIPT_URL) {
                  const nomComplet = `${student.prenom} ${student.nom}`;
                  envoyerAGoogleSheets({
                    type: 'suivi',
                    nom: nomComplet,
                    typeAction: 'evaluation',
                    niveau: niveau,
                    element: niveau === 'eval1' ? '√âvaluation 1' : '√âvaluation 2',
                    statut: newProg[niveau] ? 'coch√©' : 'd√©coch√©'
                  });
                  
                  // Calculer et envoyer la PROGRESSION mise √† jour
                  setTimeout(() => {
                    const updatedProgress = { ...prev, [studentId]: newProg };
                    const progressPercent = calculateProgressFromData(studentId, updatedProgress);
                    
                    envoyerAGoogleSheets({
                      type: 'progression',
                      nom: nomComplet,
                      groupe: student.groupe,
                      progression: progressPercent
                    });
                  }, 100);
                }
              }
              
              return { ...prev, [studentId]: newProg };
            });
          };

          const calculateProgressFromData = (studentId, progressData) => {
            const prog = progressData[studentId] || getStudentProgress(studentId);
            let total = 0;
            let completed = 0;

            ['niveau1', 'niveau2', 'niveau3'].forEach(niveau => {
              prog[niveau].videos.forEach(done => {
                total++;
                if (done) completed++;
              });
              prog[niveau].exercices.forEach(done => {
                total++;
                if (done) completed++;
              });
            });
            
            total += 2;
            if (prog.eval1) completed++;
            if (prog.eval2) completed++;

            return Math.round((completed / total) * 100);
          };

          const calculateProgress = (studentId) => {
            const prog = getStudentProgress(studentId);
            let total = 0;
            let completed = 0;

            ['niveau1', 'niveau2', 'niveau3'].forEach(niveau => {
              prog[niveau].videos.forEach(done => {
                total++;
                if (done) completed++;
              });
              prog[niveau].exercices.forEach(done => {
                total++;
                if (done) completed++;
              });
            });
            
            total += 2;
            if (prog.eval1) completed++;
            if (prog.eval2) completed++;

            return Math.round((completed / total) * 100);
          };

          const filteredStudents = filterGroupe === 'tous' 
            ? students 
            : students.filter(s => s.groupe === filterGroupe);

          // VUE S√âLECTION
          if (currentView === 'select') {
            return (
              <div className="min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 p-8">
                <div className="max-w-4xl mx-auto">
                  <div className="bg-white rounded-lg shadow-xl p-8 mb-6">
                    <h1 className="text-3xl font-bold text-indigo-900 mb-2">Formation Excel - GEA S1</h1>
                    <p className="text-gray-600 mb-4">Cours Filim - 9 s√©ances de 1h50</p>
                    <div className="flex items-center gap-2 text-sm text-gray-500">
                      <Youtube />
                      <span>Playlists YouTube Filim - Niveaux 1 et 2</span>
                    </div>
                  </div>
                  
                  <div className="grid md:grid-cols-2 gap-6">
                    <button
                      onClick={() => setCurrentView('student')}
                      className="bg-white p-8 rounded-lg shadow-lg hover:shadow-xl transition-all group"
                    >
                      <div className="flex justify-center mb-4">
                        <User />
                      </div>
                      <h2 className="text-2xl font-bold text-gray-800 mb-2">Espace √âtudiant</h2>
                      <p className="text-gray-600">Je suis mon propre parcours</p>
                    </button>
                    
                    <button
                      onClick={() => setCurrentView('teacher')}
                      className="bg-white p-8 rounded-lg shadow-lg hover:shadow-xl transition-all group"
                    >
                      <div className="flex justify-center mb-4">
                        <BarChart3 />
                      </div>
                      <h2 className="text-2xl font-bold text-gray-800 mb-2">Espace Enseignant</h2>
                      <p className="text-gray-600">Vue globale des 57 √©tudiants</p>
                    </button>
                  </div>
                </div>
              </div>
            );
          }

          // VUE √âTUDIANT - S√âLECTION
          if (currentView === 'student' && !currentStudent) {
            return (
              <div className="min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 p-8">
                <div className="max-w-5xl mx-auto">
                  <button
                    onClick={() => setCurrentView('select')}
                    className="mb-6 text-indigo-600 hover:text-indigo-800"
                  >
                    ‚Üê Retour
                  </button>
                  
                  <div className="bg-white rounded-lg shadow-xl p-8">
                    <h2 className="text-2xl font-bold text-indigo-900 mb-6">S√©lectionnez votre nom</h2>
                    
                    <div className="flex gap-4 mb-6">
                      <button
                        onClick={() => setFilterGroupe('tous')}
                        className={`px-4 py-2 rounded-lg ${filterGroupe === 'tous' ? 'bg-indigo-600 text-white' : 'bg-gray-200'}`}
                      >
                        Tous ({students.length})
                      </button>
                      <button
                        onClick={() => setFilterGroupe('TD1')}
                        className={`px-4 py-2 rounded-lg ${filterGroupe === 'TD1' ? 'bg-indigo-600 text-white' : 'bg-gray-200'}`}
                      >
                        TD1
                      </button>
                      <button
                        onClick={() => setFilterGroupe('TD2')}
                        className={`px-4 py-2 rounded-lg ${filterGroupe === 'TD2' ? 'bg-indigo-600 text-white' : 'bg-gray-200'}`}
                      >
                        TD2
                      </button>
                    </div>

                    <div className="grid md:grid-cols-3 gap-3 max-h-96 overflow-y-auto">
                      {filteredStudents.map(student => (
                        <button
                          key={student.id}
                          onClick={() => setCurrentStudent(student)}
                          className="p-3 border rounded-lg hover:bg-indigo-50 text-left"
                        >
                          <div className="font-medium">{student.prenom} {student.nom}</div>
                          <div className="text-xs text-gray-500">{student.groupe}</div>
                        </button>
                      ))}
                    </div>
                  </div>
                </div>
              </div>
            );
          }

          // VUE √âTUDIANT - SUIVI
          if (currentView === 'student' && currentStudent) {
            const studentProg = getStudentProgress(currentStudent.id);
            const progressPercent = calculateProgress(currentStudent.id);

            return (
              <div className="min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 p-8">
                <div className="max-w-6xl mx-auto">
                  <button
                    onClick={() => setCurrentStudent(null)}
                    className="mb-6 text-indigo-600 hover:text-indigo-800"
                  >
                    ‚Üê Changer d'√©tudiant
                  </button>
                  
                  <div className="bg-white rounded-lg shadow-xl p-8 mb-6">
                    <div className="flex justify-between items-start mb-4">
                      <div>
                        <h2 className="text-2xl font-bold text-indigo-900">
                          {currentStudent.prenom} {currentStudent.nom}
                        </h2>
                        <p className="text-gray-600">{currentStudent.groupe}</p>
                      </div>
                      <div className="text-right">
                        <div className="text-4xl font-bold text-indigo-600">{progressPercent}%</div>
                        <div className="text-sm text-gray-600">Progression</div>
                      </div>
                    </div>
                    <div className="w-full bg-gray-200 rounded-full h-4">
                      <div 
                        className="bg-indigo-600 h-4 rounded-full transition-all"
                        style={{ width: `${progressPercent}%` }}
                      />
                    </div>
                  </div>

                  <div className="bg-white rounded-lg shadow-xl p-6 mb-6">
                    <h3 className="text-xl font-bold mb-4 flex items-center gap-2">
                      <BookOpen />
                      Planning des 9 s√©ances
                    </h3>
                    <div className="grid grid-cols-3 md:grid-cols-9 gap-2">
                      {sessions.map(s => (
                        <div key={s.num} className={`border rounded p-2 text-center ${s.content.includes('√âVALUATION') ? 'bg-red-50 border-red-400' : ''}`}>
                          <div className="font-bold text-indigo-600 text-sm">S{s.num}</div>
                          <div className="text-xs text-gray-600">{s.duree}</div>
                        </div>
                      ))}
                    </div>
                  </div>

                  {Object.entries(courseStructure).map(([key, niveau]) => (
                    <div key={key} className={`bg-white rounded-lg shadow-xl p-6 mb-6 ${niveau.bonus ? 'border-4 border-yellow-400' : ''}`}>
                      <div className="flex justify-between items-center mb-4">
                        <div className="flex items-center gap-3">
                          <h3 className="text-xl font-bold">{niveau.title}</h3>
                          {niveau.bonus && (
                            <span className="bg-yellow-400 text-yellow-900 px-3 py-1 rounded-full text-sm font-bold">
                              ‚≠ê BONUS
                            </span>
                          )}
                        </div>
                        <a 
                          href={niveau.playlistCours}
                          target="_blank"
                          className="flex items-center gap-2 text-indigo-600 text-sm"
                        >
                          <Youtube />
                          Voir les cours
                        </a>
                      </div>
                      
                      {niveau.bonus && (
                        <div className="bg-yellow-50 border border-yellow-200 rounded-lg p-3 mb-4">
                          <p className="text-sm text-yellow-800">
                            ‚ú® <strong>Contenu optionnel :</strong> Ce niveau est pour ceux qui veulent aller plus loin ! 
                            Compl√©tez d'abord les niveaux 1 et 2.
                          </p>
                        </div>
                      )}
                      
                      <div className="space-y-3">
                        <div className="font-semibold">üîπ Vid√©os :</div>
                        {niveau.videos.map((video, idx) => (
                          <div key={idx} className="border border-gray-200 rounded-lg p-3">
                            <div
                              onClick={() => toggleItem(currentStudent.id, key, 'video', idx)}
                              className="flex items-center gap-3 hover:bg-gray-50 cursor-pointer"
                            >
                              {studentProg[key].videos[idx] ? <CheckSquare /> : <Square />}
                              <span className={studentProg[key].videos[idx] ? 'line-through text-gray-500' : ''}>
                                {video.titre}
                              </span>
                            </div>
                            {video.quiz && (
                              <div className="mt-2 ml-8">
                                <a
                                  href={`${video.quiz}?nom=${encodeURIComponent(currentStudent.prenom + ' ' + currentStudent.nom)}`}
                                  target="_blank"
                                  rel="noopener noreferrer"
                                  className="text-sm text-purple-600 hover:text-purple-800 hover:underline"
                                  onClick={() => {
                                    localStorage.setItem('currentStudentName', `${currentStudent.prenom} ${currentStudent.nom}`);
                                  }}
                                >
                                  üéØ Faire le quiz
                                </a>
                              </div>
                            )}
                          </div>
                        ))}
                        
                        <div className="font-semibold mt-4 flex justify-between">
                          <span>‚úèÔ∏è Exercices :</span>
                          <a href={niveau.playlistExercices} target="_blank" className="text-sm text-indigo-600 flex items-center gap-1">
                            <Youtube />
                            Voir
                          </a>
                        </div>
                        {niveau.exercices.map((ex, idx) => (
                          <div
                            key={idx}
                            onClick={() => toggleItem(currentStudent.id, key, 'exercice', idx)}
                            className="flex items-center gap-3 p-3 border-2 border-indigo-200 rounded-lg hover:bg-indigo-50 cursor-pointer"
                          >
                            {studentProg[key].exercices[idx] ? <CheckSquare /> : <Square />}
                            <span className={studentProg[key].exercices[idx] ? 'line-through text-gray-500 font-medium' : 'font-medium'}>
                              {ex}
                            </span>
                          </div>
                        ))}
                      </div>
                    </div>
                  ))}

                  <div className="bg-white rounded-lg shadow-xl p-6">
                    <h3 className="text-xl font-bold mb-4 flex items-center gap-2">
                      <Award />
                      √âvaluations
                    </h3>
                    <div className="space-y-3">
                      <div
                        onClick={() => toggleItem(currentStudent.id, 'eval1', 'eval')}
                        className="flex items-center gap-3 p-4 border-2 border-red-200 rounded-lg hover:bg-red-50 cursor-pointer"
                      >
                        {studentProg.eval1 ? <CheckSquare /> : <Square />}
                        <div>
                          <div className={studentProg.eval1 ? 'line-through text-gray-500 font-medium' : 'font-medium'}>
                            √âvaluation 1
                          </div>
                          <div className="text-sm text-gray-600">S√©ance 4</div>
                        </div>
                      </div>
                      
                      <div
                        onClick={() => toggleItem(currentStudent.id, 'eval2', 'eval')}
                        className="flex items-center gap-3 p-4 border-2 border-red-200 rounded-lg hover:bg-red-50 cursor-pointer"
                      >
                        {studentProg.eval2 ? <CheckSquare /> : <Square />}
                        <div>
                          <div className={studentProg.eval2 ? 'line-through text-gray-500 font-medium' : 'font-medium'}>
                            √âvaluation 2 finale
                          </div>
                          <div className="text-sm text-gray-600">S√©ance 9</div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            );
          }

          // VUE ENSEIGNANT
          if (currentView === 'teacher') {
            const studentStats = students.map(s => ({
              ...s,
              progress: calculateProgress(s.id)
            })).sort((a, b) => a.progress - b.progress);

            const avg = Math.round(studentStats.reduce((sum, s) => sum + s.progress, 0) / students.length);
            const td1 = studentStats.filter(s => s.groupe === 'TD1');
            const td2 = studentStats.filter(s => s.groupe === 'TD2');
            const avgTD1 = Math.round(td1.reduce((sum, s) => sum + s.progress, 0) / td1.length);
            const avgTD2 = Math.round(td2.reduce((sum, s) => sum + s.progress, 0) / td2.length);

            return (
              <div className="min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 p-8">
                <div className="max-w-7xl mx-auto">
                  <button
                    onClick={() => setCurrentView('select')}
                    className="mb-6 text-indigo-600 hover:text-indigo-800"
                  >
                    ‚Üê Retour
                  </button>
                  
                  <div className="bg-white rounded-lg shadow-xl p-8 mb-6">
                    <h2 className="text-2xl font-bold text-indigo-900 mb-4">Tableau de bord</h2>
                    <div className="grid md:grid-cols-4 gap-4">
                      <div className="bg-indigo-50 p-4 rounded-lg">
                        <div className="text-3xl font-bold text-indigo-600">{avg}%</div>
                        <div className="text-sm text-gray-600">Moyenne g√©n√©rale</div>
                      </div>
                      <div className="bg-blue-50 p-4 rounded-lg">
                        <div className="text-3xl font-bold text-blue-600">{avgTD1}%</div>
                        <div className="text-sm text-gray-600">TD1 ({td1.length})</div>
                      </div>
                      <div className="bg-purple-50 p-4 rounded-lg">
                        <div className="text-3xl font-bold text-purple-600">{avgTD2}%</div>
                        <div className="text-sm text-gray-600">TD2 ({td2.length})</div>
                      </div>
                      <div className="bg-orange-50 p-4 rounded-lg">
                        <div className="text-3xl font-bold text-orange-600">
                          {studentStats.filter(s => s.progress < 30).length}
                        </div>
                        <div className="text-sm text-gray-600">&lt; 30%</div>
                      </div>
                    </div>
                  </div>

                  <div className="bg-white rounded-lg shadow-xl p-8">
                    <h3 className="text-xl font-bold mb-4">Progression individuelle</h3>
                    
                    <div className="flex gap-4 mb-4">
                      <button
                        onClick={() => setFilterGroupe('tous')}
                        className={`px-4 py-2 rounded-lg text-sm ${filterGroupe === 'tous' ? 'bg-indigo-600 text-white' : 'bg-gray-200'}`}
                      >
                        Tous
                      </button>
                      <button
                        onClick={() => setFilterGroupe('TD1')}
                        className={`px-4 py-2 rounded-lg text-sm ${filterGroupe === 'TD1' ? 'bg-blue-600 text-white' : 'bg-gray-200'}`}
                      >
                        TD1
                      </button>
                      <button
                        onClick={() => setFilterGroupe('TD2')}
                        className={`px-4 py-2 rounded-lg text-sm ${filterGroupe === 'TD2' ? 'bg-purple-600 text-white' : 'bg-gray-200'}`}
                      >
                        TD2
                      </button>
                    </div>

                    <div className="space-y-2 max-h-96 overflow-y-auto">
                      {(filterGroupe === 'tous' ? studentStats : studentStats.filter(s => s.groupe === filterGroupe)).map(s => (
                        <div key={s.id} className="flex items-center gap-4 p-3 border rounded-lg hover:bg-gray-50">
                          <div className="w-48 font-medium text-sm">
                            {s.prenom} {s.nom}
                          </div>
                          <div className={`w-12 text-xs px-2 py-1 rounded ${s.groupe === 'TD1' ? 'bg-blue-100 text-blue-700' : 'bg-purple-100 text-purple-700'}`}>
                            {s.groupe}
                          </div>
                          <div className="flex-1">
                            <div className="w-full bg-gray-200 rounded-full h-4">
                              <div
                                className={`h-4 rounded-full ${
                                  s.progress >= 80 ? 'bg-green-500' :
                                  s.progress >= 50 ? 'bg-blue-500' :
                                  s.progress >= 30 ? 'bg-orange-500' : 'bg-red-500'
                                }`}
                                style={{ width: `${s.progress}%` }}
                              />
                            </div>
                          </div>
                          <div className="w-16 text-right font-bold">
                            {s.progress}%
                          </div>
                          <button
                            onClick={() => {
                              setCurrentStudent(s);
                              setCurrentView('student');
                            }}
                            className="px-3 py-1 bg-indigo-100 text-indigo-600 rounded hover:bg-indigo-200 text-sm"
                          >
                            Voir
                          </button>
                        </div>
                      ))}
                    </div>
                  </div>
                </div>
              </div>
            );
          }
        };

        ReactDOM.render(<ExcelTrackingApp />, document.getElementById('root'));
    </script>
</body>
</html>